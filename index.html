<!DOCTYPE html>
<html lang="kr">
<head>
    <meta charset="UTF-8">
    <title>서울 공공 데이터 표시</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        td.congestion {
            font-weight: bold;
            color: #fff;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>서울 지역 혼잡도 정보</h1>
    <table id="congestionTable">
        <thead>
            <tr>
                <th>지역명</th>
                <th>혼잡도 색상</th>
                <th>혼잡도 레벨</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <script>
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "https://data.seoul.go.kr/SeoulRtd/getCategoryList?page=1&category=%EC%A0%84%EC%B2%B4%EB%B3%B4%EA%B8%B0&count=15&sort=true", true);
        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4 && xhr.status == 200) {
                var data = JSON.parse(xhr.responseText);
                var tableBody = document.getElementById('congestionTable').getElementsByTagName('tbody')[0];

                data.row.forEach(function(item) {
                    var row = tableBody.insertRow();
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
                    var cell3 = row.insertCell(2);

                    cell1.textContent = item.area_nm;
                    cell2.textContent = item.congestion_color;
                    cell2.style.backgroundColor = item.congestion_color;
                    cell2.style.color = getContrastColor(item.congestion_color);
                    cell3.textContent = item.area_congest_lvl;
                });
            }
        };
        xhr.send();

        function getContrastColor(hexcolor){
            // Simple function to calculate contrast color for better readability
            var r = parseInt(hexcolor.substr(1,2),16);
            var g = parseInt(hexcolor.substr(3,2),16);
            var b = parseInt(hexcolor.substr(5,2),16);
            var yiq = ((r*299)+(g*587)+(b*114))/1000;
            return (yiq >= 128) ? 'black' : 'white';
        }
    </script>
</body>
</html>
